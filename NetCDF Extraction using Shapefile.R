library(raster)
library(ggplot2)
library(ncdf4)
library(maptools)
library(sf)

setwd("C:/DATOS CMIP5/IPSL-CM5A-MR")
pt = shapefile("C:/DATOS CMIP5/Estaciones_CORDEX_Catchira_GEO.shp")
pt@coords <- pt@coords[, 1:2]

data <- st_read("C:/DATOS CMIP5/Estaciones_CORDEX_Catchira_GEO.shp")
head(data)

#Definimos series de tiempo
#ts1 = seq(as.Date("1951-01-01"),as.Date("1955-12-30"),by = "day")
ts2 = seq(as.Date("1956-01-01"),as.Date("1960-12-31"),by = "day")
#ts3 = seq(as.Date("1961-01-01"),as.Date("1965-12-31"),by = "day")
#ts4 = seq(as.Date("1966-01-01"),as.Date("1970-12-31"),by = "day")
#ts5 = seq(as.Date("1971-01-01"),as.Date("1975-12-31"),by = "day")
#ts6 = seq(as.Date("1976-01-01"),as.Date("1980-12-31"),by = "day")
#ts7 = seq(as.Date("1981-01-01"),as.Date("1985-12-31"),by = "day")
#ts8 = seq(as.Date("1986-01-01"),as.Date("1990-12-31"),by = "day")
#ts9 = seq(as.Date("1991-01-01"),as.Date("1995-12-31"),by = "day")
#ts10 = seq(as.Date("1996-01-01"),as.Date("2000-12-31"),by = "day")
#ts11 = seq(as.Date("2001-01-01"),as.Date("2005-12-31"),by = "day")
#ts12 = seq(as.Date("2006-01-01"),as.Date("2010-12-31"),by = "day")
#ts13 = seq(as.Date("2011-01-01"),as.Date("2015-12-31"),by = "day")
#ts14 = seq(as.Date("2016-01-01"),as.Date("2020-12-31"),by = "day")
#ts15 = seq(as.Date("2021-01-01"),as.Date("2025-12-31"),by = "day")
#ts16 = seq(as.Date("2026-01-01"),as.Date("2030-12-31"),by = "day")
#ts17 = seq(as.Date("2031-01-01"),as.Date("2035-12-31"),by = "day")
#ts18 = seq(as.Date("2036-01-01"),as.Date("2040-12-31"),by = "day")
#ts19 = seq(as.Date("2041-01-01"),as.Date("2045-12-31"),by = "day")
#ts20 = seq(as.Date("2046-01-01"),as.Date("2050-12-31"),by = "day")
#ts21 = seq(as.Date("2051-01-01"),as.Date("2055-12-31"),by = "day")
#ts22 = seq(as.Date("2056-01-01"),as.Date("2060-12-31"),by = "day")
#ts23 = seq(as.Date("2061-01-01"),as.Date("2065-12-31"),by = "day")
#ts24 = seq(as.Date("2066-01-01"),as.Date("2070-12-31"),by = "day")
#ts25 = seq(as.Date("2071-01-01"),as.Date("2075-12-31"),by = "day")
#ts26 = seq(as.Date("2076-01-01"),as.Date("2080-12-31"),by = "day")
#ts27 = seq(as.Date("2081-01-01"),as.Date("2085-12-31"),by = "day")
#ts28 = seq(as.Date("2086-01-01"),as.Date("2090-12-31"),by = "day")
#ts29 = seq(as.Date("2091-01-01"),as.Date("2095-12-31"),by = "day")
#ts30 = seq(as.Date("2096-01-01"),as.Date("2100-12-31"),by = "day")

#Seguir colocando ts's si se necesitase más fechas

#Definimos bricks para archivos NetCDF

#Datos históricos del modelo GCM
nc1 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19510101-19551231.nc",na.rm = TRUE)
nc2 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19560101-19601231.nc",na.rm = TRUE)
nc3 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19610101-19651231.nc",na.rm = TRUE)
nc4 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19660101-19701231.nc",na.rm = TRUE)
nc5 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19710101-19751231.nc",na.rm = TRUE)
nc6 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19760101-19801231.nc",na.rm = TRUE)
nc7 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19810101-19851231.nc",na.rm = TRUE)
nc8 = brick("C:/DATOS/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19860101-19901231.nc",na.rm = TRUE)
nc9 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19910101-19951231.nc",na.rm = TRUE)
nc10 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_19960101-20001231.nc",na.rm = TRUE)
nc11 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_historical_r1i1p1_SMHI-RCA4_v3_day_20010101-20051231.nc",na.rm = TRUE)


#Datos proyectactos RCP2.6
nc12 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20060101-20101231.nc",na.rm = TRUE)
nc13 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20110101-20151231.nc",na.rm = TRUE)
nc14 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20160101-20201231.nc",na.rm = TRUE)
nc15 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20210101-20251231.nc",na.rm = TRUE)
nc16 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20260101-20301231.nc",na.rm = TRUE)
nc17 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20310101-20351231.nc",na.rm = TRUE)
nc18 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20360101-20401231.nc",na.rm = TRUE)
nc19 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20410101-20451231.nc",na.rm = TRUE)
nc20 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20460101-20501231.nc",na.rm = TRUE)
nc21 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20510101-20551231.nc",na.rm = TRUE)
nc22 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20560101-20601231.nc",na.rm = TRUE)
nc23 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20610101-20651231.nc",na.rm = TRUE)
nc24 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20660101-20701231.nc",na.rm = TRUE)
nc25 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20710101-20751231.nc",na.rm = TRUE)
nc26 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20760101-20801231.nc",na.rm = TRUE)
nc27 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20810101-20851231.nc",na.rm = TRUE)
nc28 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20860101-20901231.nc",na.rm = TRUE)
nc29 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20910101-20951231.nc",na.rm = TRUE)
nc30 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20960101-21001231.nc",na.rm = TRUE)

#Datos proyectados RCP4.5
nc31 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20060101-20101231.nc",na.rm = TRUE)
nc32 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20110101-20151231.nc",na.rm = TRUE)
nc33 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20160101-20201231.nc",na.rm = TRUE)
nc34 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20210101-20251231.nc",na.rm = TRUE)
nc35 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20260101-20301231.nc",na.rm = TRUE)
nc36 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20310101-20351231.nc",na.rm = TRUE)
nc37 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20360101-20401231.nc",na.rm = TRUE)
nc38 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20410101-20451231.nc",na.rm = TRUE)
nc39 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20460101-20501231.nc",na.rm = TRUE)
nc40 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20510101-20551231.nc",na.rm = TRUE)
nc41 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20560101-20601231.nc",na.rm = TRUE)
nc42 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20610101-20651231.nc",na.rm = TRUE)
nc43 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20660101-20701231.nc",na.rm = TRUE)
nc44 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20710101-20751231.nc",na.rm = TRUE)
nc45 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20760101-20801231.nc",na.rm = TRUE)
nc46 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20810101-20851231.nc",na.rm = TRUE)
nc47 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20860101-20901231.nc",na.rm = TRUE)
nc48 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20910101-20951231.nc",na.rm = TRUE)
nc49 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp45_r1i1p1_SMHI-RCA4_v3_day_20960101-21001231.nc",na.rm = TRUE)

#Datos proyectados RCP8.5
nc50 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20060101-20101231.nc",na.rm = TRUE)
nc51 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20110101-20151231.nc",na.rm = TRUE)
nc52 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20160101-20201231.nc",na.rm = TRUE)
nc53 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20210101-20251231.nc",na.rm = TRUE)
nc54 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20260101-20301231.nc",na.rm = TRUE)
nc55 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20310101-20351231.nc",na.rm = TRUE)
nc56 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20360101-20401231.nc",na.rm = TRUE)
nc57 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20410101-20451231.nc",na.rm = TRUE)
nc58 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20460101-20501231.nc",na.rm = TRUE)
nc59 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20510101-20551231.nc",na.rm = TRUE)
nc60 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20560101-20601231.nc",na.rm = TRUE)
nc61 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20610101-20651231.nc",na.rm = TRUE)
nc62 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20660101-20701231.nc",na.rm = TRUE)
nc63 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20710101-20751231.nc",na.rm = TRUE)
nc64 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20760101-20801231.nc",na.rm = TRUE)
nc65 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20810101-20851231.nc",na.rm = TRUE)
nc66 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20860101-20901231.nc",na.rm = TRUE)
nc67 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20910101-20951231.nc",na.rm = TRUE)
nc68 = brick("C:/DATOS CMIP5/IPSL-CM5A-MR/pr_SAM-44_IPSL-IPSL-CM5A-MR_rcp85_r1i1p1_SMHI-RCA4_v3_day_20960101-21001231.nc",na.rm = TRUE)
#Seguir colocando nc's si se necesitase.

#Extracción de datos a partir del archivo shapefile
ext1 = extract(nc1, pt)
ext2 = extract(nc2, pt)
ext3 = extract(nc3, pt)
ext4 = extract(nc4, pt)
ext5 = extract(nc5, pt)
ext6 = extract(nc6, pt)
ext7 = extract(nc7, pt)
ext8 = extract(nc8, pt)
ext9 = extract(nc9, pt)
ext10 = extract(nc10, pt)
ext11 = extract(nc11, pt)
ext12 = extract(nc12, pt)
ext13 = extract(nc13, pt)
ext14 = extract(nc14, pt)
ext15 = extract(nc15, pt)
ext16 = extract(nc16, pt)
ext17 = extract(nc17, pt)
ext18 = extract(nc18, pt)
ext19 = extract(nc19, pt)
ext20 = extract(nc20, pt)
ext21 = extract(nc21, pt)
ext22 = extract(nc22, pt)
ext23 = extract(nc23, pt)
ext24 = extract(nc24, pt)
ext25 = extract(nc25, pt)
ext26 = extract(nc26, pt)
ext27 = extract(nc27, pt)
ext28 = extract(nc28, pt)
ext29 = extract(nc29, pt)
ext30 = extract(nc30, pt)
ext31 = extract(nc31, pt)
ext32 = extract(nc32, pt)
ext33 = extract(nc33, pt)
ext34 = extract(nc34, pt)
ext35 = extract(nc35, pt)
ext36 = extract(nc36, pt)
ext37 = extract(nc37, pt)
ext38 = extract(nc38, pt)
ext39 = extract(nc39, pt)
ext40 = extract(nc40, pt)
ext41 = extract(nc41, pt)
ext42 = extract(nc42, pt)
ext43 = extract(nc43, pt)
ext44 = extract(nc44, pt)
ext45 = extract(nc45, pt)
ext46 = extract(nc46, pt)
ext47 = extract(nc47, pt)
ext48 = extract(nc48, pt)
ext49 = extract(nc49, pt)
ext50 = extract(nc50, pt)
ext51 = extract(nc51, pt)
ext52 = extract(nc52, pt)
ext53 = extract(nc53, pt)
ext54 = extract(nc54, pt)
ext55 = extract(nc55, pt)
ext56 = extract(nc56, pt)
ext57 = extract(nc57, pt)
ext58 = extract(nc58, pt)
ext59 = extract(nc59, pt)
ext60 = extract(nc60, pt)
ext61 = extract(nc61, pt)
ext62 = extract(nc62, pt)
ext63 = extract(nc63, pt)
ext64 = extract(nc64, pt)
ext65 = extract(nc65, pt)
ext66 = extract(nc66, pt)
ext67 = extract(nc67, pt)
ext68 = extract(nc68, pt)
#Seguir colocando ext's si se necesitase.

#Ploteamos como prueba un resultado
plot(ext1[2,],type = "l")
# Asignando indices
idx <- getZ(nc2)

#Generamos los data frames para cada información extraída de cada archivo NetCDF
df1 = data.frame(t(ext1))
df2 = data.frame(t(ext2))
df3 = data.frame(t(ext3))
df4 = data.frame(t(ext4))
df5 = data.frame(t(ext5))
#Seguir colocando df's si se necesitase.

#Guardamos en un archivo .csv el dataframe que deseamos
#En este caso, guardaremos el df1
write.table(df1,file="C:/DATOS CMIP5/df1.csv", col.names=NA, row.names=idx,sep=",")  
write.table(df1,file="C:/DATOS CMIP5/datos.csv",sep=",")  
